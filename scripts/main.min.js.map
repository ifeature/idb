{"version":3,"sources":["main.min.js","/source/main.js"],"names":["_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","MaterialMenu","init","this","element_","container","document","createElement","classList","add","CssClasses_","CONTAINER","parentElement","insertBefore","removeChild","appendChild","container_","outline","OUTLINE","outline_","forElId","getAttribute","forEl","getElementById","buttonsFound","getElementsByTagName","btn","forElement_","addEventListener","handleForClick_","bind","handleForKeyboardEvent_","items","querySelectorAll","ITEM","boundItemKeydown","handleItemKeyboardEvent_","boundItemClick","handleItemClick_","tabIndex","contains","RIPPLE_EFFECT","RIPPLE_IGNORE_EVENTS","item","rippleContainer","ITEM_RIPPLE_CONTAINER","ripple","RIPPLE","BOTTOM_LEFT","BOTTOM_RIGHT","TOP_LEFT","TOP_RIGHT","UNALIGNED","IS_UPGRADED","indexedDBOk","window","checkValidity","fields","every","field","value","validity","typeMismatch","showError","errorName","errorMessage","tpl","dialog","content","firstElementChild","cloneNode","innerHTML","replace","body","showModal","dialogPolyfill","registerDialog","querySelector","close","remove","updateTable","addRecord","tableRow","userName","userCountry","userEmail","menuButton","menu","componentHandler","upgradeElement","tbody","deleteUserBtn","deleteUser","editUserBtn","user","id","showDialog","tBodies","hasChildNodes","transaction","db","storeName","objectStore","requestAmount","count","request","openCursor","event","cursor","result","addUser","error","name","message","showSnackBar","editUser","put","dialogTitle","userEdit","userObj","title","firstChild","createTextNode","hasAttribute","console","log","Snackbar","show","main","openRequest","indexedDB","open","dbName","dbVersion","thisDB","objectStoreNames","createObjectStore","keyPath","autoIncrement","createIndex","unique","addUserButton","isLocalhost","Boolean","location","hostname","match","navigator","protocol","serviceWorker","register","then","registration","update","onupdatefound","controller","installingWorker","installing","onstatechange","state","Error","e","element","create","snackbarContainer","data","setTimeout","MaterialSnackbar","showSnackbar","snackbar"],"mappings":"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","file":"main.min.js","sourcesContent":["'use strict';\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*!\n *\n *  Web Starter Kit\n *  Copyright 2015 Google Inc. All rights reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    https://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License\n *\n */\n/* eslint-env browser */\n\n/**\n * Credit: https://github.com/google/material-design-lite/issues/1491\n */\nMaterialMenu.prototype.init = function () {\n  if (this.element_) {\n    // Create container for the menu.\n    var container = document.createElement('div');\n    container.classList.add(this.CssClasses_.CONTAINER);\n    this.element_.parentElement.insertBefore(container, this.element_);\n    this.element_.parentElement.removeChild(this.element_);\n    container.appendChild(this.element_);\n    this.container_ = container;\n    // Create outline for the menu (shadow and background).\n    var outline = document.createElement('div');\n    outline.classList.add(this.CssClasses_.OUTLINE);\n    this.outline_ = outline;\n    container.insertBefore(outline, this.element_);\n    // Find the \"for\" element and bind events to it.\n    var forElId = this.element_.getAttribute('for');\n    var forEl = null;\n    if (forElId) {\n      forEl = document.getElementById(forElId);\n\n      // ***** START OF NEW CODE *****\n      if (!forEl) {\n        var buttonsFound = this.element_.parentElement.parentElement.getElementsByTagName(\"button\");\n        for (var btn = 0; btn < buttonsFound.length; btn++) {\n          if (buttonsFound[btn].getAttribute(\"id\") === forElId) {\n            forEl = buttonsFound[btn];\n          }\n        }\n      }\n      // ***** END OF NEW CODE *****\n\n      if (forEl) {\n        this.forElement_ = forEl;\n        forEl.addEventListener('click', this.handleForClick_.bind(this));\n        forEl.addEventListener('keydown', this.handleForKeyboardEvent_.bind(this));\n      }\n    }\n    var items = this.element_.querySelectorAll('.' + this.CssClasses_.ITEM);\n    this.boundItemKeydown = this.handleItemKeyboardEvent_.bind(this);\n    this.boundItemClick = this.handleItemClick_.bind(this);\n    for (var i = 0; i < items.length; i++) {\n      // Add a listener to each menu item.\n      items[i].addEventListener('click', this.boundItemClick);\n      // Add a tab index to each menu item.\n      items[i].tabIndex = '-1';\n      // Add a keyboard listener to each menu item.\n      items[i].addEventListener('keydown', this.boundItemKeydown);\n    }\n    // Add ripple classes to each item, if the user has enabled ripples.\n    if (this.element_.classList.contains(this.CssClasses_.RIPPLE_EFFECT)) {\n      this.element_.classList.add(this.CssClasses_.RIPPLE_IGNORE_EVENTS);\n      for (i = 0; i < items.length; i++) {\n        var item = items[i];\n        var rippleContainer = document.createElement('span');\n        rippleContainer.classList.add(this.CssClasses_.ITEM_RIPPLE_CONTAINER);\n        var ripple = document.createElement('span');\n        ripple.classList.add(this.CssClasses_.RIPPLE);\n        rippleContainer.appendChild(ripple);\n        item.appendChild(rippleContainer);\n        item.classList.add(this.CssClasses_.RIPPLE_EFFECT);\n      }\n    }\n    // Copy alignment classes to the container, so the outline can use them.\n    if (this.element_.classList.contains(this.CssClasses_.BOTTOM_LEFT)) {\n      this.outline_.classList.add(this.CssClasses_.BOTTOM_LEFT);\n    }\n    if (this.element_.classList.contains(this.CssClasses_.BOTTOM_RIGHT)) {\n      this.outline_.classList.add(this.CssClasses_.BOTTOM_RIGHT);\n    }\n    if (this.element_.classList.contains(this.CssClasses_.TOP_LEFT)) {\n      this.outline_.classList.add(this.CssClasses_.TOP_LEFT);\n    }\n    if (this.element_.classList.contains(this.CssClasses_.TOP_RIGHT)) {\n      this.outline_.classList.add(this.CssClasses_.TOP_RIGHT);\n    }\n    if (this.element_.classList.contains(this.CssClasses_.UNALIGNED)) {\n      this.outline_.classList.add(this.CssClasses_.UNALIGNED);\n    }\n    container.classList.add(this.CssClasses_.IS_UPGRADED);\n  }\n};\n\n(function () {\n  'use strict';\n\n  // Check to make sure service workers are supported in the current browser,\n  // and that the current page is accessed from a secure origin. Using a\n  // service worker from an insecure origin will trigger JS console errors. See\n  // http://www.chromium.org/Home/chromium-security/prefer-secure-origins-for-powerful-new-features\n\n  var isLocalhost = Boolean(window.location.hostname === 'localhost' ||\n  // [::1] is the IPv6 localhost address.\n  window.location.hostname === '[::1]' ||\n  // 127.0.0.1/8 is considered localhost for IPv4.\n  window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));\n\n  if ('serviceWorker' in navigator && (window.location.protocol === 'https:' || isLocalhost)) {\n    navigator.serviceWorker.register('service-worker.js').then(function (registration) {\n      // Check to see if there's an updated version of service-worker.js with\n      // new files to cache:\n      // https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-update-method\n      if (typeof registration.update === 'function') {\n        registration.update();\n      }\n\n      // updatefound is fired if service-worker.js changes.\n      registration.onupdatefound = function () {\n        // updatefound is also fired the very first time the SW is installed,\n        // and there's no need to prompt for a reload at that point.\n        // So check here to see if the page is already controlled,\n        // i.e. whether there's an existing service worker.\n        if (navigator.serviceWorker.controller) {\n          // The updatefound event implies that registration.installing is set:\n          // https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-container-updatefound-event\n          var installingWorker = registration.installing;\n\n          installingWorker.onstatechange = function () {\n            switch (installingWorker.state) {\n              case 'installed':\n                // At this point, the old content will have been purged and the\n                // fresh content will have been added to the cache.\n                // It's the perfect time to display a \"New content is\n                // available; please refresh.\" message in the page's interface.\n                break;\n\n              case 'redundant':\n                throw new Error('The installing ' + 'service worker became redundant.');\n\n              default:\n              // Ignore\n            }\n          };\n        }\n      };\n    }).catch(function (e) {\n      console.error('Error during service worker registration:', e);\n    });\n  }\n\n  // Your custom JavaScript goes here\n\n  var db = void 0;\n  var openRequest = void 0;\n  var dbName = 'addressBook.db';\n  var dbVersion = 1;\n  var storeName = 'users';\n\n  function indexedDBOk() {\n    return 'indexedDB' in window;\n  }\n\n  function checkValidity(fields) {\n    return fields.every(function (field) {\n      return field.value && !field.validity.typeMismatch;\n    });\n  }\n\n  function showError(errorName, errorMessage) {\n    errorName = errorName || 'Unknown error';\n    errorMessage = errorMessage || '';\n\n    var tpl = document.getElementById('error-template');\n    var dialog = tpl.content.firstElementChild.cloneNode(true);\n    dialog.innerHTML = dialog.innerHTML.replace(/{{errorName}}/ig, errorName).replace(/{{errorMessage}}/ig, errorMessage);\n\n    document.body.appendChild(dialog);\n\n    if (!dialog.showModal) {\n      dialogPolyfill.registerDialog(dialog);\n    }\n\n    dialog.showModal();\n\n    dialog.querySelector('.close').addEventListener('click', function () {\n      dialog.close();\n      dialog.remove();\n    });\n  }\n\n  var Snackbar = function () {\n    function Snackbar() {\n      _classCallCheck(this, Snackbar);\n\n      if (!Snackbar.element) {\n        this.element = Snackbar.create();\n        Snackbar.element = this.element;\n      } else {\n        this.element = Snackbar.element;\n      }\n    }\n\n    _createClass(Snackbar, [{\n      key: 'show',\n      value: function show(message) {\n        var snackbarContainer = document.getElementById('demo-toast-example');\n\n        var data = { message: message };\n\n        // Bottleneck\n        setTimeout(function () {\n          snackbarContainer.MaterialSnackbar.showSnackbar(data);\n        }, 2000);\n\n        return this;\n      }\n    }], [{\n      key: 'create',\n      value: function create() {\n        var tpl = document.getElementById('snackbar-template');\n        var snackbar = tpl.content.cloneNode(true);\n\n        document.body.appendChild(snackbar);\n        return snackbar;\n      }\n    }]);\n\n    return Snackbar;\n  }();\n  /**\n   * Action-list issue :C\n   */\n\n\n  function updateTable() {\n    var tbody = document.getElementById('users').tBodies[0];\n    while (tbody.hasChildNodes()) {\n      tbody.firstElementChild.remove();\n    }\n\n    var transaction = db.transaction([storeName], 'readonly');\n    var objectStore = transaction.objectStore(storeName);\n    var requestAmount = objectStore.count();\n    var request = objectStore.openCursor(null, 'next');\n\n    request.addEventListener('success', function (event) {\n      var cursor = event.target.result;\n\n      if (cursor) {\n        addRecord(cursor.key, cursor.value);\n        cursor.continue();\n      }\n    });\n\n    requestAmount.addEventListener('success', function (event) {\n      var result = event.target.result;\n      document.getElementById('totalAmout').innerHTML = result;\n    });\n\n    function addRecord(key, value) {\n      var tpl = document.getElementById('record-template');\n      var tableRow = tpl.content.firstElementChild.cloneNode(true);\n\n      tableRow.innerHTML = tableRow.innerHTML.replace(/{{id}}/ig, key).replace(/{{userName}}/ig, value.userName).replace(/{{userCountry}}/ig, value.userCountry).replace(/{{userEmail}}/ig, value.userEmail);\n\n      var menuButton = tableRow.querySelector('.show-actions-button');\n      var menu = tableRow.querySelector('.actions-menu');\n      componentHandler.upgradeElement(menuButton, \"MaterialButton\");\n      componentHandler.upgradeElement(menu, \"MaterialMenu\");\n\n      tbody.appendChild(tableRow);\n\n      var deleteUserBtn = tableRow.querySelector('.delete-user-button');\n      deleteUserBtn.addEventListener('click', function () {\n        deleteUser(key);\n      });\n\n      var editUserBtn = tableRow.querySelector('.edit-user-button');\n\n      var user = {\n        userName: value.userName,\n        userCountry: value.userCountry,\n        userEmail: value.userEmail,\n        id: key\n      };\n      editUserBtn.addEventListener('click', function () {\n        showDialog('Edit user', true, user);\n      });\n    }\n  }\n\n  function addUser(user) {\n    var transaction = db.transaction([storeName], 'readwrite');\n    var objectStore = transaction.objectStore(storeName);\n    var request = objectStore.add(user);\n\n    request.addEventListener('error', function (event) {\n      var error = event.target.error;\n      showError(error.name, error.message);\n    });\n\n    request.addEventListener('success', function (event) {\n      var result = event.target.result;\n    });\n\n    transaction.addEventListener('complete', function (event) {\n      showSnackBar('User was added');\n      updateTable();\n    });\n  }\n\n  function deleteUser(id) {\n    var transaction = db.transaction([storeName], 'readwrite');\n    var objectStore = transaction.objectStore(storeName);\n    var request = objectStore.delete(id);\n\n    request.addEventListener('error', function (event) {\n      var error = event.target.error;\n      showError(error.name, error.message);\n    });\n\n    request.addEventListener('success', function (event) {\n      var result = event.target.result;\n    });\n\n    transaction.addEventListener('complete', function (event) {\n      showSnackBar('User was deleted');\n      updateTable();\n    });\n  }\n\n  function editUser(user) {\n    var transaction = db.transaction([storeName], 'readwrite');\n    var objectStore = transaction.objectStore(storeName);\n    var request = objectStore.put(user);\n\n    request.addEventListener('error', function (event) {\n      var error = event.target.error;\n      showError(error.name, error.message);\n    });\n\n    request.addEventListener('success', function (event) {\n      var result = event.target.result;\n    });\n\n    transaction.addEventListener('complete', function (event) {\n      showSnackBar('User was edited');\n      updateTable();\n    });\n  }\n\n  function showDialog(dialogTitle, userEdit, userObj) {\n    var user = {};\n\n    var dialog = document.querySelector('dialog');\n    var title = dialog.querySelector('.mdl-dialog__title');\n    var userName = dialog.querySelector('#userName');\n    var userCountry = dialog.querySelector('#userCountry');\n    var userEmail = dialog.querySelector('#userEmail');\n\n    if (userEdit) {\n      userName.value = userObj.userName;\n      userCountry.value = userObj.userCountry;\n      userEmail.value = userObj.userEmail;\n    }\n\n    while (title.hasChildNodes()) {\n      title.firstChild.remove();\n    }\n\n    title.appendChild(document.createTextNode(dialogTitle));\n\n    if (!dialog.showModal) {\n      dialogPolyfill.registerDialog(dialog);\n    }\n\n    dialog.showModal();\n\n    dialog.querySelector('.close').addEventListener('click', function () {\n      if (dialog.hasAttribute('open')) {\n        dialog.close();\n      }\n    });\n\n    dialog.querySelector('.agree').addEventListener('click', function () {\n      if (checkValidity([userName, userCountry, userEmail])) {\n        user.userName = userName.value;\n        user.userCountry = userCountry.value;\n        user.userEmail = userEmail.value;\n\n        if (userEdit) {\n          console.log('Editing');\n          user.id = userObj.id;\n          editUser(user);\n        } else {\n          console.log('Adding');\n          addUser(user);\n        }\n\n        userName.value = '';\n        userCountry.value = '';\n        userEmail.value = '';\n      }\n      if (dialog.hasAttribute('open')) {\n        dialog.close();\n      }\n    });\n  }\n\n  function showSnackBar(message) {\n    new Snackbar().show(message);\n  }\n\n  document.addEventListener('DOMContentLoaded', main);\n\n  function main() {\n    if (!indexedDBOk()) return;\n\n    /**\n     * For developing purposes only!\n     */\n    function deleteDB() {\n      var DBDeleteRequest = indexedDB.deleteDatabase(dbName);\n\n      DBDeleteRequest.onerror = function (event) {\n        showSnackBar('Error: ' + event.errorCode);\n      };\n\n      DBDeleteRequest.onsuccess = function (event) {\n        showSnackBar('DB was deleted successfully');\n      };\n    }\n\n    // deleteDB();\n\n    openRequest = indexedDB.open(dbName, dbVersion);\n\n    openRequest.addEventListener('blocked', function (event) {\n      var error = event.target.error;\n\n      showSnackBar('Connection request was blocked');\n    });\n\n    openRequest.addEventListener('error', function (event) {\n      var error = event.target.error;\n      showError(error.name, error.message);\n    });\n\n    openRequest.addEventListener('upgradeneeded', function (event) {\n      var thisDB = event.target.result;\n\n      // For developing purposes only!\n      // thisDB.deleteObjectStore(storeName);\n\n      if (!thisDB.objectStoreNames.contains(storeName)) {\n        var objectStore = thisDB.createObjectStore(storeName, { keyPath: 'id', autoIncrement: true });\n        objectStore.createIndex('idxEmail', 'userEmail', { unique: true });\n        objectStore.createIndex('idxCountry', 'userCountry', { unique: false });\n      }\n\n      showSnackBar('DB was initialized / created');\n    });\n\n    openRequest.addEventListener('success', function (event) {\n      db = event.target.result;\n\n      showSnackBar('DB was loaded successfully');\n      updateTable();\n    });\n\n    var addUserButton = document.getElementById('add');\n    addUserButton.addEventListener('click', function () {\n      showDialog('Add new user', false);\n    });\n  }\n})();\n//# sourceMappingURL=data:application/json;base64,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QU0sU0FBUyxNQUFNLE1BQU4sQ0FBYSxNQUFiOzs7OztBQUQ2QyxVQU14RCxDQUFDLE9BQU8sZ0JBQVAsQ0FBd0IsUUFBeEIsQ0FBaUMsU0FBakMsQ0FBRCxFQUE4QztBQUNoRCxZQUFNLGNBQWMsT0FBTyxpQkFBUCxDQUF5QixTQUF6QixFQUFvQyxFQUFDLFNBQVMsSUFBVCxFQUFlLGVBQWUsSUFBZixFQUFwRCxDQUFkLENBRDBDO0FBRWhELG9CQUFZLFdBQVosQ0FBd0IsVUFBeEIsRUFBb0MsV0FBcEMsRUFBaUQsRUFBQyxRQUFRLElBQVIsRUFBbEQsRUFGZ0Q7QUFHaEQsb0JBQVksV0FBWixDQUF3QixZQUF4QixFQUFzQyxhQUF0QyxFQUFxRCxFQUFDLFFBQVEsS0FBUixFQUF0RCxFQUhnRDtPQUFsRDs7QUFNQSxtQkFBYSw4QkFBYixFQVo0RDtLQUFoQixDQUE5QyxDQWpDYzs7QUFnRGQsZ0JBQVksZ0JBQVosQ0FBNkIsU0FBN0IsRUFBd0MsVUFBUyxLQUFULEVBQWdCO0FBQ3RELFdBQUssTUFBTSxNQUFOLENBQWEsTUFBYixDQURpRDs7QUFHdEQsbUJBQWEsNEJBQWIsRUFIc0Q7QUFJdEQsb0JBSnNEO0tBQWhCLENBQXhDLENBaERjOztBQXVEZCxRQUFNLGdCQUFnQixTQUFTLGNBQVQsQ0FBd0IsS0FBeEIsQ0FBaEIsQ0F2RFE7QUF3RGQsa0JBQWMsZ0JBQWQsQ0FBK0IsT0FBL0IsRUFBd0MsWUFBVztBQUNqRCxpQkFBVyxjQUFYLEVBQTJCLEtBQTNCLEVBRGlEO0tBQVgsQ0FBeEMsQ0F4RGM7R0FBaEI7Q0FuVUQsQ0FBRCIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKlxuICogIFdlYiBTdGFydGVyIEtpdFxuICogIENvcHlyaWdodCAyMDE1IEdvb2dsZSBJbmMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKlxuICogIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiAgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgIGh0dHBzOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiAgVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqICBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqICBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiAgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2VcbiAqXG4gKi9cbi8qIGVzbGludC1lbnYgYnJvd3NlciAqL1xuXG4vKipcbiAqIENyZWRpdDogaHR0cHM6Ly9naXRodWIuY29tL2dvb2dsZS9tYXRlcmlhbC1kZXNpZ24tbGl0ZS9pc3N1ZXMvMTQ5MVxuICovXG5NYXRlcmlhbE1lbnUucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7XG4gIGlmICh0aGlzLmVsZW1lbnRfKSB7XG4gICAgLy8gQ3JlYXRlIGNvbnRhaW5lciBmb3IgdGhlIG1lbnUuXG4gICAgdmFyIGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKHRoaXMuQ3NzQ2xhc3Nlc18uQ09OVEFJTkVSKTtcbiAgICB0aGlzLmVsZW1lbnRfLnBhcmVudEVsZW1lbnQuaW5zZXJ0QmVmb3JlKGNvbnRhaW5lciwgdGhpcy5lbGVtZW50Xyk7XG4gICAgdGhpcy5lbGVtZW50Xy5wYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKHRoaXMuZWxlbWVudF8pO1xuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLmVsZW1lbnRfKTtcbiAgICB0aGlzLmNvbnRhaW5lcl8gPSBjb250YWluZXI7XG4gICAgLy8gQ3JlYXRlIG91dGxpbmUgZm9yIHRoZSBtZW51IChzaGFkb3cgYW5kIGJhY2tncm91bmQpLlxuICAgIHZhciBvdXRsaW5lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgb3V0bGluZS5jbGFzc0xpc3QuYWRkKHRoaXMuQ3NzQ2xhc3Nlc18uT1VUTElORSk7XG4gICAgdGhpcy5vdXRsaW5lXyA9IG91dGxpbmU7XG4gICAgY29udGFpbmVyLmluc2VydEJlZm9yZShvdXRsaW5lLCB0aGlzLmVsZW1lbnRfKTtcbiAgICAvLyBGaW5kIHRoZSBcImZvclwiIGVsZW1lbnQgYW5kIGJpbmQgZXZlbnRzIHRvIGl0LlxuICAgIHZhciBmb3JFbElkID0gdGhpcy5lbGVtZW50Xy5nZXRBdHRyaWJ1dGUoJ2ZvcicpO1xuICAgIHZhciBmb3JFbCA9IG51bGw7XG4gICAgaWYgKGZvckVsSWQpIHtcbiAgICAgIGZvckVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZm9yRWxJZCk7XG5cbiAgICAgIC8vICoqKioqIFNUQVJUIE9GIE5FVyBDT0RFICoqKioqXG4gICAgICBpZiAoIWZvckVsKSB7XG4gICAgICAgIHZhciBidXR0b25zRm91bmQgPSB0aGlzLmVsZW1lbnRfLnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImJ1dHRvblwiKTtcbiAgICAgICAgZm9yICh2YXIgYnRuID0gMDsgYnRuIDwgYnV0dG9uc0ZvdW5kLmxlbmd0aDsgYnRuKyspIHtcbiAgICAgICAgICBpZiAoYnV0dG9uc0ZvdW5kW2J0bl0uZ2V0QXR0cmlidXRlKFwiaWRcIikgPT09IGZvckVsSWQpIHtcbiAgICAgICAgICAgIGZvckVsID0gYnV0dG9uc0ZvdW5kW2J0bl07XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICAvLyAqKioqKiBFTkQgT0YgTkVXIENPREUgKioqKipcblxuICAgICAgaWYgKGZvckVsKSB7XG4gICAgICAgIHRoaXMuZm9yRWxlbWVudF8gPSBmb3JFbDtcbiAgICAgICAgZm9yRWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmhhbmRsZUZvckNsaWNrXy5iaW5kKHRoaXMpKTtcbiAgICAgICAgZm9yRWwuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuaGFuZGxlRm9yS2V5Ym9hcmRFdmVudF8uYmluZCh0aGlzKSk7XG4gICAgICB9XG4gICAgfVxuICAgIHZhciBpdGVtcyA9IHRoaXMuZWxlbWVudF8ucXVlcnlTZWxlY3RvckFsbCgnLicgKyB0aGlzLkNzc0NsYXNzZXNfLklURU0pO1xuICAgIHRoaXMuYm91bmRJdGVtS2V5ZG93biA9IHRoaXMuaGFuZGxlSXRlbUtleWJvYXJkRXZlbnRfLmJpbmQodGhpcyk7XG4gICAgdGhpcy5ib3VuZEl0ZW1DbGljayA9IHRoaXMuaGFuZGxlSXRlbUNsaWNrXy5iaW5kKHRoaXMpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIC8vIEFkZCBhIGxpc3RlbmVyIHRvIGVhY2ggbWVudSBpdGVtLlxuICAgICAgaXRlbXNbaV0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmJvdW5kSXRlbUNsaWNrKTtcbiAgICAgIC8vIEFkZCBhIHRhYiBpbmRleCB0byBlYWNoIG1lbnUgaXRlbS5cbiAgICAgIGl0ZW1zW2ldLnRhYkluZGV4ID0gJy0xJztcbiAgICAgIC8vIEFkZCBhIGtleWJvYXJkIGxpc3RlbmVyIHRvIGVhY2ggbWVudSBpdGVtLlxuICAgICAgaXRlbXNbaV0uYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuYm91bmRJdGVtS2V5ZG93bik7XG4gICAgfVxuICAgIC8vIEFkZCByaXBwbGUgY2xhc3NlcyB0byBlYWNoIGl0ZW0sIGlmIHRoZSB1c2VyIGhhcyBlbmFibGVkIHJpcHBsZXMuXG4gICAgaWYgKHRoaXMuZWxlbWVudF8uY2xhc3NMaXN0LmNvbnRhaW5zKHRoaXMuQ3NzQ2xhc3Nlc18uUklQUExFX0VGRkVDVCkpIHtcbiAgICAgIHRoaXMuZWxlbWVudF8uY2xhc3NMaXN0LmFkZCh0aGlzLkNzc0NsYXNzZXNfLlJJUFBMRV9JR05PUkVfRVZFTlRTKTtcbiAgICAgIGZvciAoaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgaXRlbSA9IGl0ZW1zW2ldO1xuICAgICAgICB2YXIgcmlwcGxlQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgICByaXBwbGVDb250YWluZXIuY2xhc3NMaXN0LmFkZCh0aGlzLkNzc0NsYXNzZXNfLklURU1fUklQUExFX0NPTlRBSU5FUik7XG4gICAgICAgIHZhciByaXBwbGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICAgIHJpcHBsZS5jbGFzc0xpc3QuYWRkKHRoaXMuQ3NzQ2xhc3Nlc18uUklQUExFKTtcbiAgICAgICAgcmlwcGxlQ29udGFpbmVyLmFwcGVuZENoaWxkKHJpcHBsZSk7XG4gICAgICAgIGl0ZW0uYXBwZW5kQ2hpbGQocmlwcGxlQ29udGFpbmVyKTtcbiAgICAgICAgaXRlbS5jbGFzc0xpc3QuYWRkKHRoaXMuQ3NzQ2xhc3Nlc18uUklQUExFX0VGRkVDVCk7XG4gICAgICB9XG4gICAgfVxuICAgIC8vIENvcHkgYWxpZ25tZW50IGNsYXNzZXMgdG8gdGhlIGNvbnRhaW5lciwgc28gdGhlIG91dGxpbmUgY2FuIHVzZSB0aGVtLlxuICAgIGlmICh0aGlzLmVsZW1lbnRfLmNsYXNzTGlzdC5jb250YWlucyh0aGlzLkNzc0NsYXNzZXNfLkJPVFRPTV9MRUZUKSkge1xuICAgICAgdGhpcy5vdXRsaW5lXy5jbGFzc0xpc3QuYWRkKHRoaXMuQ3NzQ2xhc3Nlc18uQk9UVE9NX0xFRlQpO1xuICAgIH1cbiAgICBpZiAodGhpcy5lbGVtZW50Xy5jbGFzc0xpc3QuY29udGFpbnModGhpcy5Dc3NDbGFzc2VzXy5CT1RUT01fUklHSFQpKSB7XG4gICAgICB0aGlzLm91dGxpbmVfLmNsYXNzTGlzdC5hZGQodGhpcy5Dc3NDbGFzc2VzXy5CT1RUT01fUklHSFQpO1xuICAgIH1cbiAgICBpZiAodGhpcy5lbGVtZW50Xy5jbGFzc0xpc3QuY29udGFpbnModGhpcy5Dc3NDbGFzc2VzXy5UT1BfTEVGVCkpIHtcbiAgICAgIHRoaXMub3V0bGluZV8uY2xhc3NMaXN0LmFkZCh0aGlzLkNzc0NsYXNzZXNfLlRPUF9MRUZUKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuZWxlbWVudF8uY2xhc3NMaXN0LmNvbnRhaW5zKHRoaXMuQ3NzQ2xhc3Nlc18uVE9QX1JJR0hUKSkge1xuICAgICAgdGhpcy5vdXRsaW5lXy5jbGFzc0xpc3QuYWRkKHRoaXMuQ3NzQ2xhc3Nlc18uVE9QX1JJR0hUKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuZWxlbWVudF8uY2xhc3NMaXN0LmNvbnRhaW5zKHRoaXMuQ3NzQ2xhc3Nlc18uVU5BTElHTkVEKSkge1xuICAgICAgdGhpcy5vdXRsaW5lXy5jbGFzc0xpc3QuYWRkKHRoaXMuQ3NzQ2xhc3Nlc18uVU5BTElHTkVEKTtcbiAgICB9XG4gICAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQodGhpcy5Dc3NDbGFzc2VzXy5JU19VUEdSQURFRCk7XG4gIH1cbn07XG5cblxuXG5cblxuXG5cbihmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIC8vIENoZWNrIHRvIG1ha2Ugc3VyZSBzZXJ2aWNlIHdvcmtlcnMgYXJlIHN1cHBvcnRlZCBpbiB0aGUgY3VycmVudCBicm93c2VyLFxuICAvLyBhbmQgdGhhdCB0aGUgY3VycmVudCBwYWdlIGlzIGFjY2Vzc2VkIGZyb20gYSBzZWN1cmUgb3JpZ2luLiBVc2luZyBhXG4gIC8vIHNlcnZpY2Ugd29ya2VyIGZyb20gYW4gaW5zZWN1cmUgb3JpZ2luIHdpbGwgdHJpZ2dlciBKUyBjb25zb2xlIGVycm9ycy4gU2VlXG4gIC8vIGh0dHA6Ly93d3cuY2hyb21pdW0ub3JnL0hvbWUvY2hyb21pdW0tc2VjdXJpdHkvcHJlZmVyLXNlY3VyZS1vcmlnaW5zLWZvci1wb3dlcmZ1bC1uZXctZmVhdHVyZXNcbiAgdmFyIGlzTG9jYWxob3N0ID0gQm9vbGVhbih3aW5kb3cubG9jYXRpb24uaG9zdG5hbWUgPT09ICdsb2NhbGhvc3QnIHx8XG4gICAgLy8gWzo6MV0gaXMgdGhlIElQdjYgbG9jYWxob3N0IGFkZHJlc3MuXG4gICAgd2luZG93LmxvY2F0aW9uLmhvc3RuYW1lID09PSAnWzo6MV0nIHx8XG4gICAgLy8gMTI3LjAuMC4xLzggaXMgY29uc2lkZXJlZCBsb2NhbGhvc3QgZm9yIElQdjQuXG4gICAgd2luZG93LmxvY2F0aW9uLmhvc3RuYW1lLm1hdGNoKFxuICAgICAgL14xMjcoPzpcXC4oPzoyNVswLTVdfDJbMC00XVswLTldfFswMV0/WzAtOV1bMC05XT8pKXszfSQvXG4gICAgKVxuICApO1xuXG4gIGlmICgnc2VydmljZVdvcmtlcicgaW4gbmF2aWdhdG9yICYmXG4gICAgKHdpbmRvdy5sb2NhdGlvbi5wcm90b2NvbCA9PT0gJ2h0dHBzOicgfHwgaXNMb2NhbGhvc3QpKSB7XG4gICAgbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIucmVnaXN0ZXIoJ3NlcnZpY2Utd29ya2VyLmpzJylcbiAgICAgIC50aGVuKGZ1bmN0aW9uKHJlZ2lzdHJhdGlvbikge1xuICAgICAgICAvLyBDaGVjayB0byBzZWUgaWYgdGhlcmUncyBhbiB1cGRhdGVkIHZlcnNpb24gb2Ygc2VydmljZS13b3JrZXIuanMgd2l0aFxuICAgICAgICAvLyBuZXcgZmlsZXMgdG8gY2FjaGU6XG4gICAgICAgIC8vIGh0dHBzOi8vc2xpZ2h0bHlvZmYuZ2l0aHViLmlvL1NlcnZpY2VXb3JrZXIvc3BlYy9zZXJ2aWNlX3dvcmtlci9pbmRleC5odG1sI3NlcnZpY2Utd29ya2VyLXJlZ2lzdHJhdGlvbi11cGRhdGUtbWV0aG9kXG4gICAgICAgIGlmICh0eXBlb2YgcmVnaXN0cmF0aW9uLnVwZGF0ZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgIHJlZ2lzdHJhdGlvbi51cGRhdGUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHVwZGF0ZWZvdW5kIGlzIGZpcmVkIGlmIHNlcnZpY2Utd29ya2VyLmpzIGNoYW5nZXMuXG4gICAgICAgIHJlZ2lzdHJhdGlvbi5vbnVwZGF0ZWZvdW5kID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgLy8gdXBkYXRlZm91bmQgaXMgYWxzbyBmaXJlZCB0aGUgdmVyeSBmaXJzdCB0aW1lIHRoZSBTVyBpcyBpbnN0YWxsZWQsXG4gICAgICAgICAgLy8gYW5kIHRoZXJlJ3Mgbm8gbmVlZCB0byBwcm9tcHQgZm9yIGEgcmVsb2FkIGF0IHRoYXQgcG9pbnQuXG4gICAgICAgICAgLy8gU28gY2hlY2sgaGVyZSB0byBzZWUgaWYgdGhlIHBhZ2UgaXMgYWxyZWFkeSBjb250cm9sbGVkLFxuICAgICAgICAgIC8vIGkuZS4gd2hldGhlciB0aGVyZSdzIGFuIGV4aXN0aW5nIHNlcnZpY2Ugd29ya2VyLlxuICAgICAgICAgIGlmIChuYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5jb250cm9sbGVyKSB7XG4gICAgICAgICAgICAvLyBUaGUgdXBkYXRlZm91bmQgZXZlbnQgaW1wbGllcyB0aGF0IHJlZ2lzdHJhdGlvbi5pbnN0YWxsaW5nIGlzIHNldDpcbiAgICAgICAgICAgIC8vIGh0dHBzOi8vc2xpZ2h0bHlvZmYuZ2l0aHViLmlvL1NlcnZpY2VXb3JrZXIvc3BlYy9zZXJ2aWNlX3dvcmtlci9pbmRleC5odG1sI3NlcnZpY2Utd29ya2VyLWNvbnRhaW5lci11cGRhdGVmb3VuZC1ldmVudFxuICAgICAgICAgICAgdmFyIGluc3RhbGxpbmdXb3JrZXIgPSByZWdpc3RyYXRpb24uaW5zdGFsbGluZztcblxuICAgICAgICAgICAgaW5zdGFsbGluZ1dvcmtlci5vbnN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIHN3aXRjaCAoaW5zdGFsbGluZ1dvcmtlci5zdGF0ZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ2luc3RhbGxlZCc6XG4gICAgICAgICAgICAgICAgICAvLyBBdCB0aGlzIHBvaW50LCB0aGUgb2xkIGNvbnRlbnQgd2lsbCBoYXZlIGJlZW4gcHVyZ2VkIGFuZCB0aGVcbiAgICAgICAgICAgICAgICAgIC8vIGZyZXNoIGNvbnRlbnQgd2lsbCBoYXZlIGJlZW4gYWRkZWQgdG8gdGhlIGNhY2hlLlxuICAgICAgICAgICAgICAgICAgLy8gSXQncyB0aGUgcGVyZmVjdCB0aW1lIHRvIGRpc3BsYXkgYSBcIk5ldyBjb250ZW50IGlzXG4gICAgICAgICAgICAgICAgICAvLyBhdmFpbGFibGU7IHBsZWFzZSByZWZyZXNoLlwiIG1lc3NhZ2UgaW4gdGhlIHBhZ2UncyBpbnRlcmZhY2UuXG4gICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ3JlZHVuZGFudCc6XG4gICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBpbnN0YWxsaW5nICcgK1xuICAgICAgICAgICAgICAgICAgICAnc2VydmljZSB3b3JrZXIgYmVjYW1lIHJlZHVuZGFudC4nKTtcblxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgLy8gSWdub3JlXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZSkge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZHVyaW5nIHNlcnZpY2Ugd29ya2VyIHJlZ2lzdHJhdGlvbjonLCBlKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8vIFlvdXIgY3VzdG9tIEphdmFTY3JpcHQgZ29lcyBoZXJlXG5cbiAgbGV0IGRiO1xuICBsZXQgb3BlblJlcXVlc3Q7XG4gIGNvbnN0IGRiTmFtZSA9ICdhZGRyZXNzQm9vay5kYic7XG4gIGNvbnN0IGRiVmVyc2lvbiA9IDE7XG4gIGNvbnN0IHN0b3JlTmFtZSA9ICd1c2Vycyc7XG5cbiAgZnVuY3Rpb24gaW5kZXhlZERCT2soKSB7XG4gICAgcmV0dXJuICdpbmRleGVkREInIGluIHdpbmRvdztcbiAgfVxuXG4gIGZ1bmN0aW9uIGNoZWNrVmFsaWRpdHkoZmllbGRzKSB7XG4gICAgcmV0dXJuIGZpZWxkcy5ldmVyeShmdW5jdGlvbihmaWVsZCkge1xuICAgICAgcmV0dXJuIGZpZWxkLnZhbHVlICYmICFmaWVsZC52YWxpZGl0eS50eXBlTWlzbWF0Y2g7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBzaG93RXJyb3IoZXJyb3JOYW1lLCBlcnJvck1lc3NhZ2UpIHtcbiAgICBlcnJvck5hbWUgPSBlcnJvck5hbWUgfHwgJ1Vua25vd24gZXJyb3InO1xuICAgIGVycm9yTWVzc2FnZSA9IGVycm9yTWVzc2FnZSB8fCAnJztcblxuICAgIGNvbnN0IHRwbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlcnJvci10ZW1wbGF0ZScpO1xuICAgIGNvbnN0IGRpYWxvZyA9IHRwbC5jb250ZW50LmZpcnN0RWxlbWVudENoaWxkLmNsb25lTm9kZSh0cnVlKTtcbiAgICBkaWFsb2cuaW5uZXJIVE1MID0gZGlhbG9nLmlubmVySFRNTFxuICAgICAgLnJlcGxhY2UoL3t7ZXJyb3JOYW1lfX0vaWcsIGVycm9yTmFtZSlcbiAgICAgIC5yZXBsYWNlKC97e2Vycm9yTWVzc2FnZX19L2lnLCBlcnJvck1lc3NhZ2UpO1xuXG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChkaWFsb2cpO1xuXG4gICAgaWYgKCFkaWFsb2cuc2hvd01vZGFsKSB7XG4gICAgICBkaWFsb2dQb2x5ZmlsbC5yZWdpc3RlckRpYWxvZyhkaWFsb2cpO1xuICAgIH1cblxuICAgIGRpYWxvZy5zaG93TW9kYWwoKTtcblxuICAgIGRpYWxvZy5xdWVyeVNlbGVjdG9yKCcuY2xvc2UnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgICAgZGlhbG9nLmNsb3NlKCk7XG4gICAgICBkaWFsb2cucmVtb3ZlKCk7XG4gICAgfSk7XG4gIH1cblxuICBjbGFzcyBTbmFja2JhciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICBpZiAoIVNuYWNrYmFyLmVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gU25hY2tiYXIuY3JlYXRlKCk7XG4gICAgICAgIFNuYWNrYmFyLmVsZW1lbnQgPSB0aGlzLmVsZW1lbnQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmVsZW1lbnQgPSBTbmFja2Jhci5lbGVtZW50O1xuICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY3JlYXRlKCkge1xuICAgICAgY29uc3QgdHBsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NuYWNrYmFyLXRlbXBsYXRlJyk7XG4gICAgICBjb25zdCBzbmFja2JhciA9IHRwbC5jb250ZW50LmNsb25lTm9kZSh0cnVlKTtcblxuICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChzbmFja2Jhcik7XG4gICAgICByZXR1cm4gc25hY2tiYXI7XG4gICAgfVxuICAgIHNob3cobWVzc2FnZSkge1xuICAgICAgY29uc3Qgc25hY2tiYXJDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGVtby10b2FzdC1leGFtcGxlJyk7XG5cbiAgICAgIGNvbnN0IGRhdGEgPSB7bWVzc2FnZTogbWVzc2FnZX07XG5cbiAgICAgIC8vIEJvdHRsZW5lY2tcbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHNuYWNrYmFyQ29udGFpbmVyLk1hdGVyaWFsU25hY2tiYXIuc2hvd1NuYWNrYmFyKGRhdGEpO1xuICAgICAgfSwgMjAwMCk7XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgfVxuICAvKipcbiAgICogQWN0aW9uLWxpc3QgaXNzdWUgOkNcbiAgICovXG4gIGZ1bmN0aW9uIHVwZGF0ZVRhYmxlKCkge1xuICAgIGxldCB0Ym9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1c2VycycpLnRCb2RpZXNbMF07XG4gICAgd2hpbGUgKHRib2R5Lmhhc0NoaWxkTm9kZXMoKSkge1xuICAgICAgdGJvZHkuZmlyc3RFbGVtZW50Q2hpbGQucmVtb3ZlKCk7XG4gICAgfVxuXG4gICAgY29uc3QgdHJhbnNhY3Rpb24gPSBkYi50cmFuc2FjdGlvbihbc3RvcmVOYW1lXSwgJ3JlYWRvbmx5Jyk7XG4gICAgY29uc3Qgb2JqZWN0U3RvcmUgPSB0cmFuc2FjdGlvbi5vYmplY3RTdG9yZShzdG9yZU5hbWUpO1xuICAgIGNvbnN0IHJlcXVlc3RBbW91bnQgPSBvYmplY3RTdG9yZS5jb3VudCgpO1xuICAgIGNvbnN0IHJlcXVlc3QgPSBvYmplY3RTdG9yZS5vcGVuQ3Vyc29yKG51bGwsICduZXh0Jyk7XG5cbiAgICByZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Y2Nlc3MnLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgY29uc3QgY3Vyc29yID0gZXZlbnQudGFyZ2V0LnJlc3VsdDtcblxuICAgICAgaWYgKGN1cnNvcikge1xuICAgICAgICBhZGRSZWNvcmQoY3Vyc29yLmtleSwgY3Vyc29yLnZhbHVlKTtcbiAgICAgICAgY3Vyc29yLmNvbnRpbnVlKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXF1ZXN0QW1vdW50LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Y2Nlc3MnLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgY29uc3QgcmVzdWx0ID0gZXZlbnQudGFyZ2V0LnJlc3VsdDtcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b3RhbEFtb3V0JykuaW5uZXJIVE1MID0gcmVzdWx0O1xuICAgIH0pO1xuXG4gICAgZnVuY3Rpb24gYWRkUmVjb3JkKGtleSwgdmFsdWUpIHtcbiAgICAgIGxldCB0cGwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVjb3JkLXRlbXBsYXRlJyk7XG4gICAgICBsZXQgdGFibGVSb3cgPSB0cGwuY29udGVudC5maXJzdEVsZW1lbnRDaGlsZC5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgICAgIHRhYmxlUm93LmlubmVySFRNTCA9IHRhYmxlUm93LmlubmVySFRNTFxuICAgICAgICAucmVwbGFjZSgve3tpZH19L2lnLCBrZXkpXG4gICAgICAgIC5yZXBsYWNlKC97e3VzZXJOYW1lfX0vaWcsIHZhbHVlLnVzZXJOYW1lKVxuICAgICAgICAucmVwbGFjZSgve3t1c2VyQ291bnRyeX19L2lnLCB2YWx1ZS51c2VyQ291bnRyeSlcbiAgICAgICAgLnJlcGxhY2UoL3t7dXNlckVtYWlsfX0vaWcsIHZhbHVlLnVzZXJFbWFpbCk7XG5cbiAgICAgIGNvbnN0IG1lbnVCdXR0b24gPSB0YWJsZVJvdy5xdWVyeVNlbGVjdG9yKCcuc2hvdy1hY3Rpb25zLWJ1dHRvbicpO1xuICAgICAgY29uc3QgbWVudSA9IHRhYmxlUm93LnF1ZXJ5U2VsZWN0b3IoJy5hY3Rpb25zLW1lbnUnKTtcbiAgICAgIGNvbXBvbmVudEhhbmRsZXIudXBncmFkZUVsZW1lbnQobWVudUJ1dHRvbiwgXCJNYXRlcmlhbEJ1dHRvblwiKTtcbiAgICAgIGNvbXBvbmVudEhhbmRsZXIudXBncmFkZUVsZW1lbnQobWVudSwgXCJNYXRlcmlhbE1lbnVcIik7XG5cbiAgICAgIHRib2R5LmFwcGVuZENoaWxkKHRhYmxlUm93KTtcblxuICAgICAgdmFyIGRlbGV0ZVVzZXJCdG4gPSB0YWJsZVJvdy5xdWVyeVNlbGVjdG9yKCcuZGVsZXRlLXVzZXItYnV0dG9uJyk7XG4gICAgICBkZWxldGVVc2VyQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIGRlbGV0ZVVzZXIoa2V5KTtcbiAgICAgIH0pO1xuXG4gICAgICB2YXIgZWRpdFVzZXJCdG4gPSB0YWJsZVJvdy5xdWVyeVNlbGVjdG9yKCcuZWRpdC11c2VyLWJ1dHRvbicpO1xuXG4gICAgICBjb25zdCB1c2VyID0ge1xuICAgICAgICB1c2VyTmFtZTogdmFsdWUudXNlck5hbWUsXG4gICAgICAgIHVzZXJDb3VudHJ5OiB2YWx1ZS51c2VyQ291bnRyeSxcbiAgICAgICAgdXNlckVtYWlsOiB2YWx1ZS51c2VyRW1haWwsXG4gICAgICAgIGlkOiBrZXlcbiAgICAgIH07XG4gICAgICBlZGl0VXNlckJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgICAgICBzaG93RGlhbG9nKCdFZGl0IHVzZXInLCB0cnVlLCB1c2VyKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICB9XG5cbiAgZnVuY3Rpb24gYWRkVXNlcih1c2VyKSB7XG4gICAgY29uc3QgdHJhbnNhY3Rpb24gPSBkYi50cmFuc2FjdGlvbihbc3RvcmVOYW1lXSwgJ3JlYWR3cml0ZScpO1xuICAgIGNvbnN0IG9iamVjdFN0b3JlID0gdHJhbnNhY3Rpb24ub2JqZWN0U3RvcmUoc3RvcmVOYW1lKTtcbiAgICBjb25zdCByZXF1ZXN0ID0gb2JqZWN0U3RvcmUuYWRkKHVzZXIpO1xuXG4gICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICBjb25zdCBlcnJvciA9IGV2ZW50LnRhcmdldC5lcnJvcjtcbiAgICAgIHNob3dFcnJvcihlcnJvci5uYW1lLCBlcnJvci5tZXNzYWdlKTtcbiAgICB9KTtcblxuICAgIHJlcXVlc3QuYWRkRXZlbnRMaXN0ZW5lcignc3VjY2VzcycsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICBjb25zdCByZXN1bHQgPSBldmVudC50YXJnZXQucmVzdWx0O1xuICAgIH0pO1xuXG4gICAgdHJhbnNhY3Rpb24uYWRkRXZlbnRMaXN0ZW5lcignY29tcGxldGUnLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgc2hvd1NuYWNrQmFyKCdVc2VyIHdhcyBhZGRlZCcpO1xuICAgICAgdXBkYXRlVGFibGUoKTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGRlbGV0ZVVzZXIoaWQpIHtcbiAgICBjb25zdCB0cmFuc2FjdGlvbiA9IGRiLnRyYW5zYWN0aW9uKFtzdG9yZU5hbWVdLCAncmVhZHdyaXRlJyk7XG4gICAgY29uc3Qgb2JqZWN0U3RvcmUgPSB0cmFuc2FjdGlvbi5vYmplY3RTdG9yZShzdG9yZU5hbWUpO1xuICAgIGNvbnN0IHJlcXVlc3QgPSBvYmplY3RTdG9yZS5kZWxldGUoaWQpO1xuXG4gICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICBjb25zdCBlcnJvciA9IGV2ZW50LnRhcmdldC5lcnJvcjtcbiAgICAgIHNob3dFcnJvcihlcnJvci5uYW1lLCBlcnJvci5tZXNzYWdlKTtcbiAgICB9KTtcblxuICAgIHJlcXVlc3QuYWRkRXZlbnRMaXN0ZW5lcignc3VjY2VzcycsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICBjb25zdCByZXN1bHQgPSBldmVudC50YXJnZXQucmVzdWx0O1xuICAgIH0pO1xuXG4gICAgdHJhbnNhY3Rpb24uYWRkRXZlbnRMaXN0ZW5lcignY29tcGxldGUnLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgc2hvd1NuYWNrQmFyKCdVc2VyIHdhcyBkZWxldGVkJyk7XG4gICAgICB1cGRhdGVUYWJsZSgpO1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gZWRpdFVzZXIodXNlcikge1xuICAgIGNvbnN0IHRyYW5zYWN0aW9uID0gZGIudHJhbnNhY3Rpb24oW3N0b3JlTmFtZV0sICdyZWFkd3JpdGUnKTtcbiAgICBjb25zdCBvYmplY3RTdG9yZSA9IHRyYW5zYWN0aW9uLm9iamVjdFN0b3JlKHN0b3JlTmFtZSk7XG4gICAgY29uc3QgcmVxdWVzdCA9IG9iamVjdFN0b3JlLnB1dCh1c2VyKTtcblxuICAgIHJlcXVlc3QuYWRkRXZlbnRMaXN0ZW5lcignZXJyb3InLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgY29uc3QgZXJyb3IgPSBldmVudC50YXJnZXQuZXJyb3I7XG4gICAgICBzaG93RXJyb3IoZXJyb3IubmFtZSwgZXJyb3IubWVzc2FnZSk7XG4gICAgfSk7XG5cbiAgICByZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Y2Nlc3MnLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgY29uc3QgcmVzdWx0ID0gZXZlbnQudGFyZ2V0LnJlc3VsdDtcbiAgICB9KTtcblxuICAgIHRyYW5zYWN0aW9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NvbXBsZXRlJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIHNob3dTbmFja0JhcignVXNlciB3YXMgZWRpdGVkJyk7XG4gICAgICB1cGRhdGVUYWJsZSgpO1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gc2hvd0RpYWxvZyhkaWFsb2dUaXRsZSwgdXNlckVkaXQsIHVzZXJPYmopIHtcbiAgICBsZXQgdXNlciA9IHt9O1xuXG4gICAgdmFyIGRpYWxvZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2RpYWxvZycpO1xuICAgIHZhciB0aXRsZSA9IGRpYWxvZy5xdWVyeVNlbGVjdG9yKCcubWRsLWRpYWxvZ19fdGl0bGUnKTtcbiAgICB2YXIgdXNlck5hbWUgPSBkaWFsb2cucXVlcnlTZWxlY3RvcignI3VzZXJOYW1lJyk7XG4gICAgdmFyIHVzZXJDb3VudHJ5ID0gZGlhbG9nLnF1ZXJ5U2VsZWN0b3IoJyN1c2VyQ291bnRyeScpO1xuICAgIHZhciB1c2VyRW1haWwgPSBkaWFsb2cucXVlcnlTZWxlY3RvcignI3VzZXJFbWFpbCcpO1xuXG4gICAgaWYgKHVzZXJFZGl0KSB7XG4gICAgICB1c2VyTmFtZS52YWx1ZSA9IHVzZXJPYmoudXNlck5hbWU7XG4gICAgICB1c2VyQ291bnRyeS52YWx1ZSA9IHVzZXJPYmoudXNlckNvdW50cnk7XG4gICAgICB1c2VyRW1haWwudmFsdWUgPSB1c2VyT2JqLnVzZXJFbWFpbDtcbiAgICB9XG5cbiAgICB3aGlsZSAodGl0bGUuaGFzQ2hpbGROb2RlcygpKSB7XG4gICAgICB0aXRsZS5maXJzdENoaWxkLnJlbW92ZSgpO1xuICAgIH1cblxuICAgIHRpdGxlLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGRpYWxvZ1RpdGxlKSk7XG5cbiAgICBpZiAoIWRpYWxvZy5zaG93TW9kYWwpIHtcbiAgICAgIGRpYWxvZ1BvbHlmaWxsLnJlZ2lzdGVyRGlhbG9nKGRpYWxvZyk7XG4gICAgfVxuXG4gICAgZGlhbG9nLnNob3dNb2RhbCgpO1xuXG4gICAgZGlhbG9nLnF1ZXJ5U2VsZWN0b3IoJy5jbG9zZScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoZGlhbG9nLmhhc0F0dHJpYnV0ZSgnb3BlbicpKSB7XG4gICAgICAgIGRpYWxvZy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgZGlhbG9nLnF1ZXJ5U2VsZWN0b3IoJy5hZ3JlZScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKGNoZWNrVmFsaWRpdHkoW3VzZXJOYW1lLCB1c2VyQ291bnRyeSwgdXNlckVtYWlsXSkpIHtcbiAgICAgICAgdXNlci51c2VyTmFtZSA9IHVzZXJOYW1lLnZhbHVlO1xuICAgICAgICB1c2VyLnVzZXJDb3VudHJ5ID0gdXNlckNvdW50cnkudmFsdWU7XG4gICAgICAgIHVzZXIudXNlckVtYWlsID0gdXNlckVtYWlsLnZhbHVlO1xuICAgICAgICBcbiAgICAgICAgaWYgKHVzZXJFZGl0KSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ0VkaXRpbmcnKTtcbiAgICAgICAgICB1c2VyLmlkID0gdXNlck9iai5pZDtcbiAgICAgICAgICBlZGl0VXNlcih1c2VyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnQWRkaW5nJyk7XG4gICAgICAgICAgYWRkVXNlcih1c2VyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHVzZXJOYW1lLnZhbHVlID0gJyc7XG4gICAgICAgIHVzZXJDb3VudHJ5LnZhbHVlID0gJyc7XG4gICAgICAgIHVzZXJFbWFpbC52YWx1ZSA9ICcnO1xuICAgICAgfVxuICAgICAgaWYgKGRpYWxvZy5oYXNBdHRyaWJ1dGUoJ29wZW4nKSkge1xuICAgICAgICBkaWFsb2cuY2xvc2UoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICB9XG5cbiAgZnVuY3Rpb24gc2hvd1NuYWNrQmFyKG1lc3NhZ2UpIHtcbiAgICBuZXcgU25hY2tiYXIoKS5zaG93KG1lc3NhZ2UpO1xuICB9XG5cbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIG1haW4pO1xuXG4gIGZ1bmN0aW9uIG1haW4oKSB7XG4gICAgaWYgKCFpbmRleGVkREJPaygpKSByZXR1cm47XG5cbiAgICAvKipcbiAgICAgKiBGb3IgZGV2ZWxvcGluZyBwdXJwb3NlcyBvbmx5IVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGRlbGV0ZURCKCkge1xuICAgICAgY29uc3QgREJEZWxldGVSZXF1ZXN0ID0gaW5kZXhlZERCLmRlbGV0ZURhdGFiYXNlKGRiTmFtZSk7XG5cbiAgICAgIERCRGVsZXRlUmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgc2hvd1NuYWNrQmFyKGBFcnJvcjogJHtldmVudC5lcnJvckNvZGV9YCk7XG4gICAgICB9O1xuXG4gICAgICBEQkRlbGV0ZVJlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgc2hvd1NuYWNrQmFyKCdEQiB3YXMgZGVsZXRlZCBzdWNjZXNzZnVsbHknKTtcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gZGVsZXRlREIoKTtcblxuICAgIG9wZW5SZXF1ZXN0ID0gaW5kZXhlZERCLm9wZW4oZGJOYW1lLCBkYlZlcnNpb24pO1xuXG4gICAgb3BlblJlcXVlc3QuYWRkRXZlbnRMaXN0ZW5lcignYmxvY2tlZCcsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICBjb25zdCBlcnJvciA9IGV2ZW50LnRhcmdldC5lcnJvcjtcblxuICAgICAgc2hvd1NuYWNrQmFyKCdDb25uZWN0aW9uIHJlcXVlc3Qgd2FzIGJsb2NrZWQnKTtcbiAgICB9KTtcblxuICAgIG9wZW5SZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIGNvbnN0IGVycm9yID0gZXZlbnQudGFyZ2V0LmVycm9yO1xuICAgICAgc2hvd0Vycm9yKGVycm9yLm5hbWUsIGVycm9yLm1lc3NhZ2UpO1xuICAgIH0pO1xuXG4gICAgb3BlblJlcXVlc3QuYWRkRXZlbnRMaXN0ZW5lcigndXBncmFkZW5lZWRlZCcsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICBjb25zdCB0aGlzREIgPSBldmVudC50YXJnZXQucmVzdWx0O1xuXG4gICAgICAvLyBGb3IgZGV2ZWxvcGluZyBwdXJwb3NlcyBvbmx5IVxuICAgICAgLy8gdGhpc0RCLmRlbGV0ZU9iamVjdFN0b3JlKHN0b3JlTmFtZSk7XG5cbiAgICAgIGlmICghdGhpc0RCLm9iamVjdFN0b3JlTmFtZXMuY29udGFpbnMoc3RvcmVOYW1lKSkge1xuICAgICAgICBjb25zdCBvYmplY3RTdG9yZSA9IHRoaXNEQi5jcmVhdGVPYmplY3RTdG9yZShzdG9yZU5hbWUsIHtrZXlQYXRoOiAnaWQnLCBhdXRvSW5jcmVtZW50OiB0cnVlfSk7XG4gICAgICAgIG9iamVjdFN0b3JlLmNyZWF0ZUluZGV4KCdpZHhFbWFpbCcsICd1c2VyRW1haWwnLCB7dW5pcXVlOiB0cnVlfSk7XG4gICAgICAgIG9iamVjdFN0b3JlLmNyZWF0ZUluZGV4KCdpZHhDb3VudHJ5JywgJ3VzZXJDb3VudHJ5Jywge3VuaXF1ZTogZmFsc2V9KTtcbiAgICAgIH1cblxuICAgICAgc2hvd1NuYWNrQmFyKCdEQiB3YXMgaW5pdGlhbGl6ZWQgLyBjcmVhdGVkJyk7XG4gICAgfSk7XG5cbiAgICBvcGVuUmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdzdWNjZXNzJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIGRiID0gZXZlbnQudGFyZ2V0LnJlc3VsdDtcblxuICAgICAgc2hvd1NuYWNrQmFyKCdEQiB3YXMgbG9hZGVkIHN1Y2Nlc3NmdWxseScpO1xuICAgICAgdXBkYXRlVGFibGUoKTtcbiAgICB9KTtcblxuICAgIGNvbnN0IGFkZFVzZXJCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYWRkJyk7XG4gICAgYWRkVXNlckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgICAgc2hvd0RpYWxvZygnQWRkIG5ldyB1c2VyJywgZmFsc2UpO1xuICAgIH0pO1xuXG4gIH1cblxufSkoKTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==\n","/*!\n *\n *  Web Starter Kit\n *  Copyright 2015 Google Inc. All rights reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    https://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License\n *\n */\n/* eslint-env browser */\n\n/**\n * Credit: https://github.com/google/material-design-lite/issues/1491\n */\nMaterialMenu.prototype.init = function () {\n  if (this.element_) {\n    // Create container for the menu.\n    var container = document.createElement('div');\n    container.classList.add(this.CssClasses_.CONTAINER);\n    this.element_.parentElement.insertBefore(container, this.element_);\n    this.element_.parentElement.removeChild(this.element_);\n    container.appendChild(this.element_);\n    this.container_ = container;\n    // Create outline for the menu (shadow and background).\n    var outline = document.createElement('div');\n    outline.classList.add(this.CssClasses_.OUTLINE);\n    this.outline_ = outline;\n    container.insertBefore(outline, this.element_);\n    // Find the \"for\" element and bind events to it.\n    var forElId = this.element_.getAttribute('for');\n    var forEl = null;\n    if (forElId) {\n      forEl = document.getElementById(forElId);\n\n      // ***** START OF NEW CODE *****\n      if (!forEl) {\n        var buttonsFound = this.element_.parentElement.parentElement.getElementsByTagName(\"button\");\n        for (var btn = 0; btn < buttonsFound.length; btn++) {\n          if (buttonsFound[btn].getAttribute(\"id\") === forElId) {\n            forEl = buttonsFound[btn];\n          }\n        }\n      }\n      // ***** END OF NEW CODE *****\n\n      if (forEl) {\n        this.forElement_ = forEl;\n        forEl.addEventListener('click', this.handleForClick_.bind(this));\n        forEl.addEventListener('keydown', this.handleForKeyboardEvent_.bind(this));\n      }\n    }\n    var items = this.element_.querySelectorAll('.' + this.CssClasses_.ITEM);\n    this.boundItemKeydown = this.handleItemKeyboardEvent_.bind(this);\n    this.boundItemClick = this.handleItemClick_.bind(this);\n    for (var i = 0; i < items.length; i++) {\n      // Add a listener to each menu item.\n      items[i].addEventListener('click', this.boundItemClick);\n      // Add a tab index to each menu item.\n      items[i].tabIndex = '-1';\n      // Add a keyboard listener to each menu item.\n      items[i].addEventListener('keydown', this.boundItemKeydown);\n    }\n    // Add ripple classes to each item, if the user has enabled ripples.\n    if (this.element_.classList.contains(this.CssClasses_.RIPPLE_EFFECT)) {\n      this.element_.classList.add(this.CssClasses_.RIPPLE_IGNORE_EVENTS);\n      for (i = 0; i < items.length; i++) {\n        var item = items[i];\n        var rippleContainer = document.createElement('span');\n        rippleContainer.classList.add(this.CssClasses_.ITEM_RIPPLE_CONTAINER);\n        var ripple = document.createElement('span');\n        ripple.classList.add(this.CssClasses_.RIPPLE);\n        rippleContainer.appendChild(ripple);\n        item.appendChild(rippleContainer);\n        item.classList.add(this.CssClasses_.RIPPLE_EFFECT);\n      }\n    }\n    // Copy alignment classes to the container, so the outline can use them.\n    if (this.element_.classList.contains(this.CssClasses_.BOTTOM_LEFT)) {\n      this.outline_.classList.add(this.CssClasses_.BOTTOM_LEFT);\n    }\n    if (this.element_.classList.contains(this.CssClasses_.BOTTOM_RIGHT)) {\n      this.outline_.classList.add(this.CssClasses_.BOTTOM_RIGHT);\n    }\n    if (this.element_.classList.contains(this.CssClasses_.TOP_LEFT)) {\n      this.outline_.classList.add(this.CssClasses_.TOP_LEFT);\n    }\n    if (this.element_.classList.contains(this.CssClasses_.TOP_RIGHT)) {\n      this.outline_.classList.add(this.CssClasses_.TOP_RIGHT);\n    }\n    if (this.element_.classList.contains(this.CssClasses_.UNALIGNED)) {\n      this.outline_.classList.add(this.CssClasses_.UNALIGNED);\n    }\n    container.classList.add(this.CssClasses_.IS_UPGRADED);\n  }\n};\n\n\n\n\n\n\n\n(function() {\n  'use strict';\n\n  // Check to make sure service workers are supported in the current browser,\n  // and that the current page is accessed from a secure origin. Using a\n  // service worker from an insecure origin will trigger JS console errors. See\n  // http://www.chromium.org/Home/chromium-security/prefer-secure-origins-for-powerful-new-features\n  var isLocalhost = Boolean(window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n  );\n\n  if ('serviceWorker' in navigator &&\n    (window.location.protocol === 'https:' || isLocalhost)) {\n    navigator.serviceWorker.register('service-worker.js')\n      .then(function(registration) {\n        // Check to see if there's an updated version of service-worker.js with\n        // new files to cache:\n        // https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-update-method\n        if (typeof registration.update === 'function') {\n          registration.update();\n        }\n\n        // updatefound is fired if service-worker.js changes.\n        registration.onupdatefound = function() {\n          // updatefound is also fired the very first time the SW is installed,\n          // and there's no need to prompt for a reload at that point.\n          // So check here to see if the page is already controlled,\n          // i.e. whether there's an existing service worker.\n          if (navigator.serviceWorker.controller) {\n            // The updatefound event implies that registration.installing is set:\n            // https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-container-updatefound-event\n            var installingWorker = registration.installing;\n\n            installingWorker.onstatechange = function() {\n              switch (installingWorker.state) {\n                case 'installed':\n                  // At this point, the old content will have been purged and the\n                  // fresh content will have been added to the cache.\n                  // It's the perfect time to display a \"New content is\n                  // available; please refresh.\" message in the page's interface.\n                  break;\n\n                case 'redundant':\n                  throw new Error('The installing ' +\n                    'service worker became redundant.');\n\n                default:\n                // Ignore\n              }\n            };\n          }\n        };\n      }).catch(function(e) {\n      console.error('Error during service worker registration:', e);\n    });\n  }\n\n  // Your custom JavaScript goes here\n\n  let db;\n  let openRequest;\n  const dbName = 'addressBook.db';\n  const dbVersion = 1;\n  const storeName = 'users';\n\n  function indexedDBOk() {\n    return 'indexedDB' in window;\n  }\n\n  function checkValidity(fields) {\n    return fields.every(function(field) {\n      return field.value && !field.validity.typeMismatch;\n    });\n  }\n\n  function showError(errorName, errorMessage) {\n    errorName = errorName || 'Unknown error';\n    errorMessage = errorMessage || '';\n\n    const tpl = document.getElementById('error-template');\n    const dialog = tpl.content.firstElementChild.cloneNode(true);\n    dialog.innerHTML = dialog.innerHTML\n      .replace(/{{errorName}}/ig, errorName)\n      .replace(/{{errorMessage}}/ig, errorMessage);\n\n    document.body.appendChild(dialog);\n\n    if (!dialog.showModal) {\n      dialogPolyfill.registerDialog(dialog);\n    }\n\n    dialog.showModal();\n\n    dialog.querySelector('.close').addEventListener('click', function() {\n      dialog.close();\n      dialog.remove();\n    });\n  }\n\n  class Snackbar {\n    constructor() {\n      if (!Snackbar.element) {\n        this.element = Snackbar.create();\n        Snackbar.element = this.element;\n      } else {\n        this.element = Snackbar.element;\n      }\n    }\n    static create() {\n      const tpl = document.getElementById('snackbar-template');\n      const snackbar = tpl.content.cloneNode(true);\n\n      document.body.appendChild(snackbar);\n      return snackbar;\n    }\n    show(message) {\n      const snackbarContainer = document.getElementById('demo-toast-example');\n\n      const data = {message: message};\n\n      // Bottleneck\n      setTimeout(function() {\n        snackbarContainer.MaterialSnackbar.showSnackbar(data);\n      }, 2000);\n\n      return this;\n    }\n  }\n  /**\n   * Action-list issue :C\n   */\n  function updateTable() {\n    let tbody = document.getElementById('users').tBodies[0];\n    while (tbody.hasChildNodes()) {\n      tbody.firstElementChild.remove();\n    }\n\n    const transaction = db.transaction([storeName], 'readonly');\n    const objectStore = transaction.objectStore(storeName);\n    const requestAmount = objectStore.count();\n    const request = objectStore.openCursor(null, 'next');\n\n    request.addEventListener('success', function(event) {\n      const cursor = event.target.result;\n\n      if (cursor) {\n        addRecord(cursor.key, cursor.value);\n        cursor.continue();\n      }\n    });\n\n    requestAmount.addEventListener('success', function(event) {\n      const result = event.target.result;\n      document.getElementById('totalAmout').innerHTML = result;\n    });\n\n    function addRecord(key, value) {\n      let tpl = document.getElementById('record-template');\n      let tableRow = tpl.content.firstElementChild.cloneNode(true);\n\n      tableRow.innerHTML = tableRow.innerHTML\n        .replace(/{{id}}/ig, key)\n        .replace(/{{userName}}/ig, value.userName)\n        .replace(/{{userCountry}}/ig, value.userCountry)\n        .replace(/{{userEmail}}/ig, value.userEmail);\n\n      const menuButton = tableRow.querySelector('.show-actions-button');\n      const menu = tableRow.querySelector('.actions-menu');\n      componentHandler.upgradeElement(menuButton, \"MaterialButton\");\n      componentHandler.upgradeElement(menu, \"MaterialMenu\");\n\n      tbody.appendChild(tableRow);\n\n      var deleteUserBtn = tableRow.querySelector('.delete-user-button');\n      deleteUserBtn.addEventListener('click', function() {\n        deleteUser(key);\n      });\n\n      var editUserBtn = tableRow.querySelector('.edit-user-button');\n\n      const user = {\n        userName: value.userName,\n        userCountry: value.userCountry,\n        userEmail: value.userEmail,\n        id: key\n      };\n      editUserBtn.addEventListener('click', function() {\n        showDialog('Edit user', true, user);\n      });\n    }\n\n  }\n\n  function addUser(user) {\n    const transaction = db.transaction([storeName], 'readwrite');\n    const objectStore = transaction.objectStore(storeName);\n    const request = objectStore.add(user);\n\n    request.addEventListener('error', function(event) {\n      const error = event.target.error;\n      showError(error.name, error.message);\n    });\n\n    request.addEventListener('success', function(event) {\n      const result = event.target.result;\n    });\n\n    transaction.addEventListener('complete', function(event) {\n      showSnackBar('User was added');\n      updateTable();\n    });\n  }\n\n  function deleteUser(id) {\n    const transaction = db.transaction([storeName], 'readwrite');\n    const objectStore = transaction.objectStore(storeName);\n    const request = objectStore.delete(id);\n\n    request.addEventListener('error', function(event) {\n      const error = event.target.error;\n      showError(error.name, error.message);\n    });\n\n    request.addEventListener('success', function(event) {\n      const result = event.target.result;\n    });\n\n    transaction.addEventListener('complete', function(event) {\n      showSnackBar('User was deleted');\n      updateTable();\n    });\n  }\n\n  function editUser(user) {\n    const transaction = db.transaction([storeName], 'readwrite');\n    const objectStore = transaction.objectStore(storeName);\n    const request = objectStore.put(user);\n\n    request.addEventListener('error', function(event) {\n      const error = event.target.error;\n      showError(error.name, error.message);\n    });\n\n    request.addEventListener('success', function(event) {\n      const result = event.target.result;\n    });\n\n    transaction.addEventListener('complete', function(event) {\n      showSnackBar('User was edited');\n      updateTable();\n    });\n  }\n\n  function showDialog(dialogTitle, userEdit, userObj) {\n    let user = {};\n\n    var dialog = document.querySelector('dialog');\n    var title = dialog.querySelector('.mdl-dialog__title');\n    var userName = dialog.querySelector('#userName');\n    var userCountry = dialog.querySelector('#userCountry');\n    var userEmail = dialog.querySelector('#userEmail');\n\n    if (userEdit) {\n      userName.value = userObj.userName;\n      userCountry.value = userObj.userCountry;\n      userEmail.value = userObj.userEmail;\n    }\n\n    while (title.hasChildNodes()) {\n      title.firstChild.remove();\n    }\n\n    title.appendChild(document.createTextNode(dialogTitle));\n\n    if (!dialog.showModal) {\n      dialogPolyfill.registerDialog(dialog);\n    }\n\n    dialog.showModal();\n\n    dialog.querySelector('.close').addEventListener('click', function() {\n      if (dialog.hasAttribute('open')) {\n        dialog.close();\n      }\n    });\n\n    dialog.querySelector('.agree').addEventListener('click', function () {\n      if (checkValidity([userName, userCountry, userEmail])) {\n        user.userName = userName.value;\n        user.userCountry = userCountry.value;\n        user.userEmail = userEmail.value;\n        \n        if (userEdit) {\n          console.log('Editing');\n          user.id = userObj.id;\n          editUser(user);\n        } else {\n          console.log('Adding');\n          addUser(user);\n        }\n\n        userName.value = '';\n        userCountry.value = '';\n        userEmail.value = '';\n      }\n      if (dialog.hasAttribute('open')) {\n        dialog.close();\n      }\n    });\n\n  }\n\n  function showSnackBar(message) {\n    new Snackbar().show(message);\n  }\n\n  document.addEventListener('DOMContentLoaded', main);\n\n  function main() {\n    if (!indexedDBOk()) return;\n\n    /**\n     * For developing purposes only!\n     */\n    function deleteDB() {\n      const DBDeleteRequest = indexedDB.deleteDatabase(dbName);\n\n      DBDeleteRequest.onerror = function(event) {\n        showSnackBar(`Error: ${event.errorCode}`);\n      };\n\n      DBDeleteRequest.onsuccess = function(event) {\n        showSnackBar('DB was deleted successfully');\n      };\n    }\n\n    // deleteDB();\n\n    openRequest = indexedDB.open(dbName, dbVersion);\n\n    openRequest.addEventListener('blocked', function(event) {\n      const error = event.target.error;\n\n      showSnackBar('Connection request was blocked');\n    });\n\n    openRequest.addEventListener('error', function(event) {\n      const error = event.target.error;\n      showError(error.name, error.message);\n    });\n\n    openRequest.addEventListener('upgradeneeded', function(event) {\n      const thisDB = event.target.result;\n\n      // For developing purposes only!\n      // thisDB.deleteObjectStore(storeName);\n\n      if (!thisDB.objectStoreNames.contains(storeName)) {\n        const objectStore = thisDB.createObjectStore(storeName, {keyPath: 'id', autoIncrement: true});\n        objectStore.createIndex('idxEmail', 'userEmail', {unique: true});\n        objectStore.createIndex('idxCountry', 'userCountry', {unique: false});\n      }\n\n      showSnackBar('DB was initialized / created');\n    });\n\n    openRequest.addEventListener('success', function(event) {\n      db = event.target.result;\n\n      showSnackBar('DB was loaded successfully');\n      updateTable();\n    });\n\n    const addUserButton = document.getElementById('add');\n    addUserButton.addEventListener('click', function() {\n      showDialog('Add new user', false);\n    });\n\n  }\n\n})();\n"],"sourceRoot":"/source/"}